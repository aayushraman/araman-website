j < -1
j <- 1
vec <- c()
vec <- c()
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
samples
annot
feat
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
hg19.dat[1,c("cCRE_ID",samples)]
cre.type <- hg19.dat[1,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
pres
pres
vec
df <- data.frame()
for(i in 1:nrow(hg19.dat)){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[1,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec)
}
View(df)
df <- data.frame()
for(i in 1:nrow(hg19.dat)){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[1,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec)
}
dim(df)
## df for UpSetR
df <- data.frame()
c(1:nrow(hg19.dat))
df <- data.frame()
df <- data.frame()
?foreach
?foreach
?foreach::foreach
df <- data.frame()
df <- foreach (i = c(1:100), .combine = rbind){ ## nrow(hg19.dat)
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
}
df <- foreach (i = c(1:100), .combine = rbind){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
}
foreach (i = c(1:100), .combine = rbind){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
}
i
c(1:100)
foreach(i = c(1:100), .combine = rbind){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
}
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
vec
vec
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
vec
df <- foreach(i = c(1:100), .combine = rbind){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
}
library(doParallel)
library(foreach)
registerDoParallel(cl <- makeCluster(3))
df <- data.frame()
df <- foreach(i = 1:100, .combine = rbind) %dopar% {
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
}
View(df)
vec
df
library(doParallel)
library(foreach)
registerDoParallel(cl <- makeCluster(3))
df <- data.frame()
foreach(i = 1:100) %dopar% {
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec)
}
rm(df)
df <- foreach(i = 1:100, .combine = "rbind") %dopar% {
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
}
df
annot
samples
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
vec
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec
)
vec
df <- data.frame()
for(i in 1:100){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec)
}
df
vec
vec <- c()
vec <- c()
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
vec
df1 <- foreach(i = 1:100, .combine = "rbind") %dopar% {
vec <- c()
foreach(j = 1:length(annot), .combine = "c") %dopar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
}
df1
df1 <- foreach(i = 1:100, .combine = "rbind") %:% {
vec <- c()
foreach(j = 1:length(annot), .combine = "c") %do% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
}
df1 <- foreach(i = 1:100, .combine = "rbind") %:% {
foreach(j = 1:length(annot), .combine = "c") %do% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
pres
}
}
df1 <- foreach(i = 1:100, .combine = "rbind") %do% {
foreach(j = 1:length(annot), .combine = "c") %do% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
pres
}
}
df1
df1
df
identical(df, df1)
dim(df)
dim(df1)
rownames(df1) <- rownames(df)
colnames(df1) <- colnames(df)
identical(df, df1)
head(df1)
head(df)
sum(df-df1)
for(i in 1:1000){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec)
}
df <- data.frame()
for(i in 1:1000){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec)
}
df1 <- foreach(i = 1:1000, .combine = "rbind") %do% {
foreach(j = 1:length(annot), .combine = "c") %do% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
pres
}
}
sum(df-df1)
df1 <- foreach(i = 1:1000, .combine = "rbind") %doPar% {
foreach(j = 1:length(annot), .combine = "c") %doPar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
pres
}
}
## df for UpSetR
library(doParallel)
library(foreach)
df1 <- foreach(i = 1:1000, .combine = "rbind") %doPar% {
foreach(j = 1:length(annot), .combine = "c") %doPar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
pres
}
}
?doPar
df1 <- foreach(i = 1:1000, .combine = "rbind") %dopar% {
foreach(j = 1:length(annot), .combine = "c") %dopar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
pres
}
}
?dopar
df1 <- foreach(i = 1:1000, .combine = "rbind") %:% {
foreach(j = 1:length(annot), .combine = "c") %dopar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
pres
}
}
df1 <- foreach(i = 1:1000, .combine = 'rbind') %:% {
foreach(j = 1:length(annot), .combine = 'c') %dopar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
pres
}
}
df1 <- foreach(i = 1:1000, .combine = 'rbind') %:%
foreach(j = 1:length(annot), .combine = 'c') %dopar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
}
df1
df <- data.frame()
for(i in 1:1000){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec)
}
df1 <- foreach(i = 1:1000, .combine = 'rbind') %:%
foreach(j = 1:length(annot), .combine = 'c') %dopar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
}
df-df1
sum(df-df1)
df <- data.frame()
system.time({
for(i in 1:10000){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec)
}
})
system.time({
df1 <- foreach(i = 1:1000, .combine = 'rbind') %:%
foreach(j = 1:length(annot), .combine = 'c') %dopar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
}
})
?microbenchmark
library(microbenchmark)
library(microbenchmark)
install.packages(microbenchmark)
install.packages("microbenchmark")
library(microbenchmark)
df <- data.frame()
microbenchmark({
for(i in 1:10000){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec)
}
})
df <- data.frame()
system.time(
for(i in 1:1000){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec)
})
system.time(
df1 <- foreach(i = 1:1000, .combine = 'rbind') %:%
foreach(j = 1:length(annot), .combine = 'c') %dopar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
}
)
system.time(
for(i in 1:10000){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec)
})
system.time(
df1 <- foreach(i = 1:10000, .combine = 'rbind') %:%
foreach(j = 1:length(annot), .combine = 'c') %dopar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
}
)
sum(df1-df)
rm(df1,df)
df <- data.frame()
system.time(
for(i in 1:10000){
vec <- c()
for(j in 1:length(annot)){
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
pres <- ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
vec <- c(vec,pres)
}
df <- rbind(df, vec)
})
df1
system.time({
df1 <- foreach(i = 1:10000, .combine = 'rbind') %:%
foreach(j = 1:length(annot), .combine = 'c') %dopar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
}
})
sum(df1-df)
rm(df,df1)
nrow(hg19.dat)
df <- foreach(i = 1:nrow(hg19.dat), .combine = 'rbind') %:%
foreach(j = 1:length(annot), .combine = 'c') %dopar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
}
rm)df
rm(df)
## df for UpSetR
library(doParallel)
library(foreach)
?registerDoParallel
registerDoParallel(cl <- makeCluster(4))
df <- foreach(i = 1:nrow(hg19.dat), .combine = 'rbind') %:%
foreach(j = 1:length(annot), .combine = 'c') %dopar% {
feat <- annot[j]
samples <- metadata[which(metadata$Annotation == feat),"sample"]
cre.type <- hg19.dat[i,c("cCRE_ID",samples)]
ifelse(sum(grepl(pattern = "H3K27ac|pELS|dELS|pELS", cre.type)) > 0, 1, 0)
}
dim(df1)
dim(df)
